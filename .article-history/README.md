# 記事履歴管理ディレクトリ

## 概要
このディレクトリは、AI News Daily Digestシステムで収集された記事の履歴を管理し、重複記事の収集を防止するために使用されます。

## ファイル構成

### `articles-history.json`
過去7日分の収集記事を記録するJSONファイル

**構造**:
```json
{
  "articles": [
    {
      "url": "記事のURL（重複チェックの主キー）",
      "title": "記事タイトル",
      "published_date": "記事の公開日（YYYY-MM-DD形式）",
      "collected_date": "収集日（YYYY-MM-DD形式）",
      "source": "出典サイト名"
    }
  ],
  "metadata": {
    "last_updated": "最終更新日時（ISO 8601形式）",
    "total_articles": "記事総数",
    "retention_days": "保持期間（デフォルト: 7日）",
    "version": "ファイルフォーマットバージョン"
  }
}
```

## 運用ルール

### メンテナンス責任者
**GitHub Copilot Coding Agent** がこのファイルを自動的にメンテナンスします。

- 毎日のニュース収集タスク実行時に、Copilotが以下の操作を実行
- 人間による手動編集は基本的に不要です
- Copilotへの指示は `.github/copilot-instructions.md` に記載されています

### 初期状態
- 履歴ファイルは、システム導入時（2026-01-28）の記事から初期化されます
- 初日はすべての記事が同じ日付（collected_date）になりますが、これは正常な動作です
- 翌日以降、異なる日付の記事が蓄積され、7日分の履歴が構築されます

### 自動メンテナンス（Copilot実行）
- **追加**: 毎日の収集時に新規記事が自動追加されます
- **削除**: 7日より古い記事は自動的に削除されます
- **更新**: `metadata.last_updated` と `metadata.total_articles` が毎回更新されます

### 重複チェックロジック
1. 記事のURL完全一致チェック（主）
2. 記事タイトルの類似度チェック（副）

### ファイルサイズ制限
- 最大サイズ: 1MB
- 超過した場合: 古い記事から削除して調整

## トラブルシューティング

### ファイルが破損した場合
自動的に新規作成されます。過去の履歴は失われますが、システムは継続動作します。

### 履歴がリセットされた場合
最大7日間は重複記事が収集される可能性がありますが、履歴が蓄積されると正常に機能します。

### 手動編集
基本的に手動編集は不要ですが、必要な場合はJSON形式を維持してください。

## 関連ドキュメント
- [重複リスク分析レポート](../docs/duplicate-article-risk-analysis.md)
- [Copilot指示書](../.github/copilot-instructions.md)

---
*Last updated: 2026-01-28*
